<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIDEASY Cinema | Stream Movies & TV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #050505;
            color: #ffffff;
            overflow-x: hidden;
        }

        .glass-nav {
            background: rgba(5, 5, 5, 0.8);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .movie-card {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .movie-card:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        .aspect-video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 16px;
            background: #000;
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.15);
        }

        .aspect-video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #050505;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #2563eb;
            border-radius: 10px;
        }

        .hero-overlay {
            background: linear-gradient(0deg, #050505 0%, rgba(5,5,5,0.7) 50%, rgba(5,5,5,0) 100%);
        }

        .shimmer {
            background: linear-gradient(90deg, #111 0%, #222 50%, #111 100%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite linear;
        }

        @keyframes shimmer {
            from { background-position: 200% 0; }
            to { background-position: -200% 0; }
        }
    </style>
</head>
<body class="custom-scrollbar">

    <!-- Navigation -->
    <nav class="glass-nav fixed top-0 w-full z-50 px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-10">
            <h1 class="text-2xl font-extrabold tracking-tighter text-blue-500 cursor-pointer" onclick="goHome()">
                VIDEASY<span class="text-white">.</span>
            </h1>
            <div class="hidden md:flex gap-8 text-sm font-semibold text-gray-400">
                <button onclick="goHome()" class="hover:text-white transition-colors">Home</button>
                <button onclick="filterType('movie')" class="hover:text-white transition-colors">Movies</button>
                <button onclick="filterType('tv')" class="hover:text-white transition-colors">TV Shows</button>
            </div>
        </div>
        
        <div class="flex items-center gap-4">
            <div class="relative">
                <input 
                    id="searchInput"
                    type="text" 
                    placeholder="Search titles..." 
                    class="bg-white/5 border border-white/10 rounded-full py-2 px-5 pl-12 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 w-48 md:w-80 transition-all text-white placeholder-gray-500"
                >
                <i class="fa-solid fa-magnifying-glass absolute left-5 top-1/2 -translate-y-1/2 text-gray-500 text-sm"></i>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 pb-12 px-6 max-w-[1600px] mx-auto">
        
        <!-- Hero Featured -->
        <section id="heroSection" class="mb-12 relative rounded-[2rem] overflow-hidden h-[500px] md:h-[650px] group">
            <img id="heroBackdrop" src="" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" alt="">
            <div class="absolute inset-0 hero-overlay"></div>
            <div class="absolute bottom-0 left-0 p-8 md:p-16 w-full md:w-3/4">
                <div class="flex items-center gap-3 mb-4">
                    <span class="bg-blue-600/20 text-blue-400 text-[10px] font-bold px-3 py-1 rounded-full border border-blue-500/30 uppercase tracking-widest">Trending Today</span>
                    <span id="heroYear" class="text-gray-400 text-sm"></span>
                </div>
                <h2 id="heroTitle" class="text-5xl md:text-7xl font-black mb-6 leading-[1.1]"></h2>
                <p id="heroOverview" class="text-gray-300 text-base md:text-lg line-clamp-3 mb-8 max-w-2xl leading-relaxed"></p>
                <div class="flex gap-4">
                    <button id="heroPlayBtn" class="bg-white text-black font-bold px-10 py-4 rounded-2xl flex items-center gap-3 hover:bg-blue-500 hover:text-white transition-all shadow-xl">
                        <i class="fa-solid fa-play"></i> Watch Now
                    </button>
                </div>
            </div>
        </section>

        <!-- Player Interface -->
        <section id="playerSection" class="mb-16 hidden">
            <div class="flex flex-col gap-8">
                <div class="flex items-center justify-between bg-white/5 p-4 rounded-2xl border border-white/10">
                    <button onclick="closePlayer()" class="text-gray-300 hover:text-white flex items-center gap-3 text-sm font-bold transition-all">
                        <i class="fa-solid fa-chevron-left"></i> RETURN TO BROWSE
                    </button>
                    <div id="playerBadge" class="flex items-center gap-3">
                        <!-- Type Badge -->
                    </div>
                </div>

                <div class="aspect-video-container">
                    <iframe id="videoPlayer" src="" frameborder="0" allowfullscreen allow="encrypted-media"></iframe>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                    <div class="lg:col-span-3 space-y-4">
                        <h2 id="playerTitle" class="text-3xl md:text-4xl font-black"></h2>
                        <div id="playerTags" class="flex flex-wrap gap-2 text-xs"></div>
                        <p id="playerDescription" class="text-gray-400 text-lg leading-relaxed pt-4"></p>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white/5 p-6 rounded-3xl border border-white/10">
                            <h4 class="text-xs font-black text-gray-500 uppercase tracking-widest mb-4">Player Options</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-medium text-gray-300">Theme Color</span>
                                    <input type="color" id="playerColor" value="#3b82f6" class="w-8 h-8 rounded-lg cursor-pointer bg-transparent border-none">
                                </div>
                                <p class="text-[10px] text-gray-500 leading-tight">Changes the player's primary UI color instantly.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Grid -->
        <section id="gridContainer">
            <div class="flex items-center justify-between mb-10">
                <h3 id="gridTitle" class="text-2xl font-extrabold tracking-tight">Movies for you</h3>
                <div id="gridLoader" class="hidden">
                    <i class="fa-solid fa-spinner fa-spin text-blue-500 text-xl"></i>
                </div>
            </div>
            
            <div id="contentGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 md:gap-8">
                <!-- Content will load here -->
            </div>
        </section>

    </main>

    <footer class="border-t border-white/5 py-16 px-6 mt-20">
        <div class="max-w-[1600px] mx-auto flex flex-col md:flex-row justify-between items-center gap-8">
            <div class="text-center md:text-left">
                <h4 class="text-xl font-black text-blue-500 mb-2">VIDEASY</h4>
                <p class="text-gray-500 text-sm">The ultimate viewing experience. Powered by TMDB & VIDEASY Player.</p>
            </div>
            <div class="flex gap-6 text-gray-400">
                <a href="#" class="hover:text-white transition-colors"><i class="fa-brands fa-instagram text-xl"></i></a>
                <a href="#" class="hover:text-white transition-colors"><i class="fa-brands fa-x-twitter text-xl"></i></a>
                <a href="#" class="hover:text-white transition-colors"><i class="fa-brands fa-github text-xl"></i></a>
            </div>
        </div>
    </footer>

    <script>
        const API_KEY = 'dc691868b09daaabe9acc238ed898cf7';
        const BASE_URL = 'https://api.themoviedb.org/3';
        const IMG_URL = 'https://image.tmdb.org/t/p/w500';
        const BACKDROP_URL = 'https://image.tmdb.org/t/p/original';

        let playerColor = '3b82f6';
        let currentItem = null;

        // Elements
        const movieGrid = document.getElementById('contentGrid');
        const heroSection = document.getElementById('heroSection');
        const playerSection = document.getElementById('playerSection');
        const videoPlayer = document.getElementById('videoPlayer');
        const searchInput = document.getElementById('searchInput');

        // Init
        window.addEventListener('DOMContentLoaded', () => {
            fetchTrending();
            initSearch();
            initColorPicker();
            initMessaging();
        });

        async function fetchTrending() {
            toggleLoader(true);
            try {
                const res = await fetch(`${BASE_URL}/trending/all/week?api_key=${API_KEY}`);
                const data = await res.json();
                const items = data.results.filter(i => i.poster_path);
                
                renderHero(items[0]);
                renderGrid(items, "Discover Trending Content");
            } catch (err) {
                console.error(err);
            } finally {
                toggleLoader(false);
            }
        }

        function initSearch() {
            let debounce;
            searchInput.addEventListener('input', (e) => {
                clearTimeout(debounce);
                debounce = setTimeout(async () => {
                    const query = e.target.value.trim();
                    if (query.length > 2) {
                        toggleLoader(true);
                        const res = await fetch(`${BASE_URL}/search/multi?api_key=${API_KEY}&query=${encodeURIComponent(query)}`);
                        const data = await res.json();
                        renderGrid(data.results.filter(i => i.poster_path), `Search Results for "${query}"`);
                        heroSection.classList.add('hidden');
                    } else if (query === "") {
                        goHome();
                    }
                }, 500);
            });
        }

        function initColorPicker() {
            document.getElementById('playerColor').addEventListener('input', (e) => {
                playerColor = e.target.value.replace('#', '');
                updatePlayerSource();
            });
        }

        function initMessaging() {
            window.addEventListener("message", (event) => {
                try {
                    const data = JSON.parse(event.data);
                    console.log("VIDEASY Analytics:", data);
                    // You could save this to localStorage for resume support
                } catch (e) {}
            });
        }

        function renderHero(item) {
            if (!item) return;
            heroSection.classList.remove('hidden');
            document.getElementById('heroBackdrop').src = BACKDROP_URL + item.backdrop_path;
            document.getElementById('heroTitle').textContent = item.title || item.name;
            document.getElementById('heroOverview').textContent = item.overview;
            document.getElementById('heroYear').textContent = (item.release_date || item.first_air_date || '').split('-')[0];
            document.getElementById('heroPlayBtn').onclick = () => openPlayer(item);
        }

        function renderGrid(items, title) {
            document.getElementById('gridTitle').textContent = title;
            movieGrid.innerHTML = '';
            
            items.forEach(item => {
                const type = item.media_type || (item.title ? 'movie' : 'tv');
                const card = document.createElement('div');
                card.className = 'movie-card cursor-pointer';
                card.onclick = () => openPlayer(item);
                
                const year = (item.release_date || item.first_air_date || '').split('-')[0];
                const rating = item.vote_average ? item.vote_average.toFixed(1) : 'N/A';

                card.innerHTML = `
                    <div class="relative aspect-[2/3] rounded-2xl overflow-hidden mb-3 group shadow-2xl">
                        <img src="${IMG_URL + item.poster_path}" class="w-full h-full object-cover" alt="">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent opacity-0 group-hover:opacity-100 transition-opacity p-4 flex flex-col justify-end">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="bg-blue-600 text-[10px] font-extrabold px-2 py-0.5 rounded uppercase">${type}</span>
                                <span class="bg-yellow-500 text-black text-[10px] font-extrabold px-2 py-0.5 rounded">★ ${rating}</span>
                            </div>
                        </div>
                    </div>
                    <h4 class="font-bold text-sm line-clamp-1 group-hover:text-blue-400 transition-colors">${item.title || item.name}</h4>
                    <p class="text-gray-500 text-xs mt-1">${year}</p>
                `;
                movieGrid.appendChild(card);
            });
        }

        function openPlayer(item) {
            currentItem = item;
            playerSection.classList.remove('hidden');
            heroSection.classList.add('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });

            document.getElementById('playerTitle').textContent = item.title || item.name;
            document.getElementById('playerDescription').textContent = item.overview;
            
            const type = item.media_type || (item.title ? 'movie' : 'tv');
            document.getElementById('playerBadge').innerHTML = `
                <span class="bg-blue-600/20 text-blue-400 text-xs font-black px-4 py-1.5 rounded-full border border-blue-500/20 uppercase tracking-tighter">
                    Streaming ${type}
                </span>
            `;

            const year = (item.release_date || item.first_air_date || '').split('-')[0];
            document.getElementById('playerTags').innerHTML = `
                <span class="bg-white/5 border border-white/10 px-3 py-1 rounded-lg text-gray-400">${year}</span>
                <span class="bg-white/5 border border-white/10 px-3 py-1 rounded-lg text-yellow-500">★ ${item.vote_average.toFixed(1)} Rating</span>
                <span class="bg-white/5 border border-white/10 px-3 py-1 rounded-lg text-gray-400">HD Available</span>
            `;

            updatePlayerSource();
        }

        function updatePlayerSource() {
            if (!currentItem) return;
            const type = currentItem.media_type || (currentItem.title ? 'movie' : 'tv');
            const id = currentItem.id;
            
            let path = `/${type}/${id}`;
            if (type === 'tv') path += '/1/1'; // Default to S1E1
            
            const params = new URLSearchParams({
                color: playerColor,
                nextEpisode: 'true',
                episodeSelector: 'true',
                autoplayNextEpisode: 'true',
                overlay: 'true'
            });

            videoPlayer.src = `https://player.videasy.net${path}?${params.toString()}`;
        }

        function closePlayer() {
            playerSection.classList.add('hidden');
            videoPlayer.src = '';
            currentItem = null;
            if (searchInput.value === "") fetchTrending();
        }

        function goHome() {
            searchInput.value = '';
            closePlayer();
            fetchTrending();
        }

        async function filterType(type) {
            toggleLoader(true);
            closePlayer();
            const res = await fetch(`${BASE_URL}/${type}/popular?api_key=${API_KEY}`);
            const data = await res.json();
            renderGrid(data.results.filter(i => i.poster_path), `Popular ${type === 'movie' ? 'Movies' : 'TV Shows'}`);
            heroSection.classList.add('hidden');
            toggleLoader(false);
        }

        function toggleLoader(show) {
            document.getElementById('gridLoader').classList.toggle('hidden', !show);
        }

    </script>
</body>
</html>

