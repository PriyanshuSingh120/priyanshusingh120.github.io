<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineView | Google Auth Bypass</title>
    <script src="https://js.puter.com/v2/"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#0b0f1a] text-slate-200 p-8 font-sans">

    <div class="max-w-4xl mx-auto bg-[#161b2b] rounded-3xl border border-slate-800 shadow-2xl overflow-hidden">
        <div class="bg-gradient-to-r from-blue-600 to-indigo-600 p-6">
            <h1 class="text-2xl font-black italic tracking-tighter">CINEVIEW GOOGLE-AUTH BYPASS</h1>
            <p class="text-blue-100 text-[10px] uppercase tracking-[0.2em]">Using API Key: 391ea7f7...24b1c33f</p>
        </div>

        <div class="p-8 space-y-6">
            <div>
                <label class="block text-[10px] font-bold text-slate-500 mb-2 uppercase tracking-widest">Paste Google Drive Links</label>
                <textarea id="linksInput" rows="10" class="w-full bg-[#0b0f1a] border border-slate-700 rounded-xl p-4 text-sm font-mono resize-none outline-none focus:border-blue-500 transition-all" placeholder="https://drive.google.com/file/d/..."></textarea>
            </div>

            <button onclick="startDirectUpload()" id="mainBtn" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-xl font-black uppercase tracking-widest transition-all shadow-lg shadow-blue-900/20">
                Start Remote Upload
            </button>

            <div id="statusLog" class="bg-black border border-slate-800 rounded-xl p-4 h-64 overflow-y-auto font-mono text-[10px] space-y-2">
                <span class="text-slate-600">// Ready. No login required for API Key users.</span>
            </div>
        </div>
    </div>

    <script>
        // Your Hardcoded API Key from your screenshot
        const MY_API_KEY = "391ea7f7e967589e017d3b3924b1c33f";

        async function startDirectUpload() {
            const links = document.getElementById('linksInput').value.trim().split('\n');
            const log = document.getElementById('statusLog');
            const btn = document.getElementById('mainBtn');

            if (!links[0]) return alert("Please paste at least one Google Drive link.");

            log.innerHTML = "";
            btn.disabled = true;
            btn.innerText = "UPLOADING...";

            for (let link of links) {
                let url = link.trim();
                if (!url) continue;

                // Extract GDrive File ID
                const driveMatch = url.match(/\/d\/(.+?)\//) || url.match(/id=(.+?)(&|$)/);
                
                if (!driveMatch) {
                    appendLog(`Skipped: Invalid URL format`, "red");
                    continue;
                }

                const fileId = driveMatch[1];
                appendLog(`Syncing FileID: ${fileId}...`, "blue");

                try {
                    // Documentation says we can use apiKey as a Query Parameter 'key'
                    const apiUrl = `https://api.abyss.to/v1/remote/${fileId}?key=${MY_API_KEY}`;

                    const response = await puter.net.fetch(apiUrl, {
                        method: 'POST',
                        headers: { 
                            'Content-Type': 'application/json'
                        }
                    });

                    // Handle potential non-JSON errors (like the Chinese block page)
                    const text = await response.text();
                    let data;
                    try {
                        data = JSON.parse(text);
                    } catch (e) {
                        throw new Error("Server blocked request or returned invalid data.");
                    }

                    if (data.id) {
                        const embed = `<iframe src="https://abyss.to/embed/${data.id}" width="100%" height="400" frameborder="0" allowfullscreen></iframe>`;
                        appendLog(`SUCCESS: ${data.name || 'File Syncing'}<br><textarea class="w-full bg-slate-900 mt-1 p-1 text-blue-400 border border-slate-800" readonly>${embed}</textarea>`, "green");
                    } else {
                        appendLog(`FAILED: ${data.message || "Unknown Abyss Error"}`, "red");
                    }
                } catch (err) {
                    appendLog(`ERROR: ${err.message}`, "red");
                }
            }

            btn.disabled = false;
            btn.innerText = "Start Remote Upload";
        }

        function appendLog(msg, color) {
            const log = document.getElementById('statusLog');
            const div = document.createElement('div');
            const colors = {
                green: "text-green-400 border-green-900/30",
                red: "text-red-400 border-red-900/30",
                blue: "text-blue-400 border-blue-900/30"
            };
            div.className = `p-2 border-b ${colors[color]} bg-slate-900/20`;
            div.innerHTML = msg;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }
    </script>
</body>
</html>
